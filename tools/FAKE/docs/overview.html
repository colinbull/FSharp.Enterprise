<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!-- 
      The What is "FAKE - F# Make"?
 parameters will be replaced with the 
      document title extracted from the <h1> element or
      file name, if there is no <h1> heading
    -->
    <title>What is "FAKE - F# Make"?
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="FAKE - F# Make">
    <meta name="author" content="Steffen Forkmann, Mauricio Scheffer, Colin Bull">
    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="content/style.css" />
    <script src="content/tips.js" type="text/javascript"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="https://github.com/fsharp/FAKE">github page</a></li>
        </ul>
        <h3 class="muted">FAKE - F# Make</h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          <h1>What is "FAKE - F# Make"?</h1>

<h2>Introduction</h2>

<p>Modern build automation systems are not limited to simply recompile programs if source code has changed. 
They are supposed to get the latest sources from a source code management system, build test databases, 
run automatic tests, check guidelines, create documentation files, install setup projects and much more. 
Some companies are even deploying virtual machines, which are created during a nightly build process. 
In order to simplify the writing of such build scripts and to provide reusability of common tasks 
most build automation systems are using a domain-specific language (DSL). 
These tools can be divided into tools using external DSLs with a custom syntax like <strong>make</strong>, 
tools using external DSLs with an XML based syntax like <strong>MSBuild</strong> or <strong>Apache Ant</strong> and 
tools using internal DSLs which are integrated in a host language like <strong>Rake</strong>, which uses Ruby.</p>

<h2>FAKE - An integrated DSL</h2>

<p>"FAKE - F# Make" is a build automation system, which is intended to combine the advantages 
of the above mentioned tools but to provide a better tooling support. 
Due to its integration in F#, all benefits of the .NET Framework and functional programming can be used, 
including the extensive class library, powerful debuggers and integrated development environments 
like Visual Studio 2008 or SharpDevelop, which provide syntax highlighting and code completion.</p>

<p>The new language was designed to be succinct, typed, declarative, extensible and easy to use. 
For instance custom build tasks can be added simply by referencing .NET assemblies and using the corresponding classes.</p>

<h2>Lastest builds and changelog</h2>

<p>You can download the latest builds from http://teamcity.codebetter.com. You don't need to register, a guest login is ok.</p>

<ul>
<li><a href="http://teamcity.codebetter.com/viewLog.html?buildId=lastSuccessful&amp;buildTypeId=bt335&amp;tab=artifacts&amp;guest=1">Latest stable build</a></li>
<li><a href="http://teamcity.codebetter.com/viewLog.html?buildId=lastSuccessful&amp;buildTypeId=bt166&amp;tab=artifacts&amp;guest=1">Latest development build</a></li>
<li><a href="http://github.com/forki/FAKE/blob/develop/changelog.markdown">Changelog</a></li>
</ul>

<h2>Nuget package</h2>

<p>We have a Nuget package at http://nuget.org/packages/FAKE. You can install it with:</p>

<pre lang="csharp">install-package FAKE</pre>

<h2>Mailing list</h2>

<p>The "FAKE - F# Make" mailing list can be found at <a href="http://groups.google.com/group/fsharpMake">http://groups.google.com/group/fsharpMake</a>.</p>

<h2>Articles</h2>

<ul>
<li><a href="gettingstarted.html">Getting started with "FAKE - F# Make"</a>: This tutorial shows you how to build the CalculatorSample project.</li>
<li><a href="http://www.navision-blog.de/2009/04/02/adding-fxcop-to-a-fake-build-script">Adding FxCop to a "FAKE" build script</a></li>
<li><a href="http://www.navision-blog.de/2009/04/05/debugging-fake-f-make-build-scripts">Debugging "FAKE - F# Make" build scripts</a></li>
<li><a href="http://www.navision-blog.de/2009/04/04/modifying-assemblyinfo-and-version-via-fake-f-make">Modifying AssemblyInfo and Version via "FAKE - F# Make"</a></li>
<li><a href="http://www.navision-blog.de/2009/04/14/writing-custom-tasks-for-fake-f-make">Writing custom tasks for "FAKE - F# Make"</a></li>
<li><a href="http://www.navision-blog.de/2009/04/15/integrate-a-fake-f-make-build-script-into-teamcity">Integrating a "FAKE - F# Make" build script into TeamCity</a></li>
<li><a href="http://www.navision-blog.de/2009/10/14/integrating-a-fake-f-make-build-script-into-cruisecontrol-net">Integrating a "FAKE - F# Make" build script into CruiseControl.NET</a></li>
<li><a href="http://www.navision-blog.de/2012/01/16/building-fake-scripts-with-jenkins/">Building FAKE scripts with Jenkins</a></li>
<li><a href="http://www.navision-blog.de/2010/11/03/running-specific-targets-in-fake-f-make/">Running specific targets in "FAKE â€“ F# Make"</a></li>
</ul>

<h2>Main Features</h2>

<ul>
<li>Simple build infrastructure</li>
<li>Easy systax</li>
<li>Full power of .NET Framework</li>
<li>Simple <a href="http://www.jetbrains.com/teamcity">TeamCity</a> integration (see <a href="http://www.navision-blog.de/2009/04/15/integrate-a-fake-f-make-build-script-into-teamcity">Integrating a "FAKE - F# Make" build script into TeamCity</a>)</li>
<li>Simple CruiseControl.NET integration (see <a href="http://www.navision-blog.de/2009/10/14/integrating-a-fake-f-make-build-script-into-cruisecontrol-net">Integrating a "FAKE - F# Make" build script into CruiseControl.NET</a>)</li>
<li>FinalTarget feature (to release resources even if build fails)</li>
<li>Extensible platform - <a href="http://www.navision-blog.de/2009/04/14/writing-custom-tasks-for-fake-f-make">Write your own tasks</a></li>
<li>Easy debugging</li>
<li>Intellisense support (when using Visual Studio)</li>
</ul>

<h2>Predefined tasks</h2>

<ul>
<li>Clean task</li>
<li><a href="http://www.nunit.org">NUnit</a> support</li>
<li><a href="http://www.codeplex.com/xunit">xUnit.net</a> support</li>
<li><a href="https://github.com/machine/machine.specifications">MSpec</a> support</li>
<li>NCover support</li>
<li>FxCop support</li>
<li>ExecProcess task (To run tools via the command line)</li>
<li>MSBuild task (to compile <em>.csproj and </em>.fsproj projects or run MSBuild scripts)</li>
<li>XMLRead task</li>
<li>VSS task (Get sources from Visual Source Safe)</li>
<li>XCopy task</li>
<li>Zip task</li>
<li><a href="http://git-scm.com/">git</a> tasks</li>
<li>AssemblyInfo task</li>
<li>MSI task (to run msi-setups with msiexec)</li>
<li>RegAsm task (to create TLBs from a .dll)</li>
<li>...</li>
</ul>

<h1>Using FAKE</h1>

<h2>Targets</h2>

<p>Targets are the main unit of work in a "FAKE - F# Make" script. 
Targets have a name and an action (given as a code block).</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// The clean target cleans the build and deploy folders</span>
<span class="i">Target</span> <span class="s">&quot;</span><span class="s">Clean</span><span class="s">&quot;</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span> 
    <span class="i">CleanDirs</span> [<span class="s">&quot;</span><span class="s">.</span><span class="s">/</span><span class="s">build</span><span class="s">/</span><span class="s">&quot;</span>; <span class="s">&quot;</span><span class="s">.</span><span class="s">/</span><span class="s">deploy</span><span class="s">/</span><span class="s">&quot;</span>]
)</pre>
</td>
</tr>
</table>

<h3>Build target order</h3>

<p>You can specify the build order using the ==> operator:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// &quot;FAKE - F# Make&quot; will run these targets in the order Clean, BuildApp, Default</span>
<span class="s">&quot;</span><span class="s">Clean</span><span class="s">&quot;</span> 
  <span class="o">==&gt;</span> <span class="s">&quot;</span><span class="s">BuildApp</span><span class="s">&quot;</span> 
  <span class="o">==&gt;</span> <span class="s">&quot;</span><span class="s">Default</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<p>If one target should only be run on a specific condition you can use the =?> operator:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="s">&quot;</span><span class="s">Clean</span><span class="s">&quot;</span> 
  <span class="o">==&gt;</span> <span class="s">&quot;</span><span class="s">BuildApp</span><span class="s">&quot;</span>
  <span class="o">=?&gt;</span> (<span class="s">&quot;</span><span class="s">Test</span><span class="s">&quot;</span>,<span class="i">hasBuildParam</span> <span class="s">&quot;</span><span class="s">test</span><span class="s">&quot;</span>)  <span class="c">// runs the Test target only if FAKE was called with parameter test</span>
  <span class="o">==&gt;</span> <span class="s">&quot;</span><span class="s">Default</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<p>It's also possible to specify the dependencies for targets:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Target Default is dependent from target Clean and BuildApp</span>
<span class="c">// &quot;FAKE - F# Make&quot; will ensure to run these targets before Default</span>
<span class="s">&quot;</span><span class="s">Default</span><span class="s">&quot;</span>  <span class="o">&lt;==</span> [<span class="s">&quot;</span><span class="s">Clean</span><span class="s">&quot;</span>; <span class="s">&quot;</span><span class="s">BuildApp</span><span class="s">&quot;</span>]</pre>
</td>
</tr>
</table>

<h3>Running targets</h3>

<p>You can execute targets with the "run"-command:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Executes Default target</span>
<span class="i">Run</span> <span class="s">&quot;</span><span class="s">Default</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<h3>Final targets</h3>

<p>Final target can be used for TearDown functionality. 
These targets will be executed even if the build fails but have to be activated via ActivateFinalTarget().</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// FinalTarget will be excuted even if build fails</span>
<span class="i">FinalTarget</span> <span class="s">&quot;</span><span class="s">CloseSomePrograms</span><span class="s">&quot;</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span>
    <span class="c">// close stuff and release resources</span>
)

<span class="c">// Activate FinalTarget somewhere during build</span>
<span class="i">ActivateFinalTarget</span> <span class="s">&quot;</span><span class="s">CloseSomePrograms</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<h2>FileSets</h2>

<p>"FAKE - F# Make" uses similar include and exclude patterns as NAnt and MSBuild.</p>

<h3>File includes</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Includes all *.csproj files under /src/app by using the !+ operator</span>
<span class="o">!+</span> <span class="s">&quot;</span><span class="s">src</span><span class="s">/</span><span class="s">app</span><span class="s">/</span><span class="s">*</span><span class="s">*</span><span class="s">/</span><span class="s">*</span><span class="s">.</span><span class="s">csproj</span><span class="s">&quot;</span>

<span class="c">// Includes all *.csproj files under /src/app and /test with the ++ operator</span>
<span class="o">!+</span> <span class="s">&quot;</span><span class="s">src</span><span class="s">/</span><span class="s">app</span><span class="s">/</span><span class="s">*</span><span class="s">*</span><span class="s">/</span><span class="s">*</span><span class="s">.</span><span class="s">csproj</span><span class="s">&quot;</span>
  <span class="o">++</span> <span class="s">&quot;</span><span class="s">test</span><span class="s">/</span><span class="s">*</span><span class="s">*</span><span class="s">/</span><span class="s">*</span><span class="s">.</span><span class="s">csproj</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<h3>File excludes</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Includes all files under /src/app but excludes *.zip files</span>
<span class="o">!+</span> <span class="s">&quot;</span><span class="s">src</span><span class="s">/</span><span class="s">app</span><span class="s">/</span><span class="s">*</span><span class="s">*</span><span class="s">/</span><span class="s">*</span><span class="s">.</span><span class="s">*</span><span class="s">&quot;</span>
  <span class="o">--</span> <span class="s">&quot;</span><span class="s">*</span><span class="s">.</span><span class="s">zip</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<h3>Scan vs. ScanImmediately</h3>

<p>"FAKE - F# Make" provides two scan methods: Scan() and ScanImmediately().</p>

<p>Scan is a lazy method and evaluates the FileSet as late as possible ("on-demand").
If the FileSet is used twice, it will be reevaluated.</p>

<p>The following code defines a lazy FileSet:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Includes all *.csproj files under /src/app and scans them lazy</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">apps</span> <span class="o">=</span> 
  <span class="o">!+</span> <span class="s">&quot;</span><span class="s">src</span><span class="s">/</span><span class="s">app</span><span class="s">/</span><span class="s">*</span><span class="s">*</span><span class="s">/</span><span class="s">*</span><span class="s">.</span><span class="s">csproj</span><span class="s">&quot;</span>
    <span class="o">|&gt;</span> <span class="i">Scan</span></pre>
</td>
</tr>
</table>

<p>The same FileSet by using the !! operator:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Includes all *.csproj files under /src/app and scans them lazy</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs1', 2)" onmouseover="showTip(event, 'fs1', 2)" class="i">apps</span> <span class="o">=</span> <span class="o">!!</span> <span class="s">&quot;</span><span class="s">src</span><span class="s">/</span><span class="s">app</span><span class="s">/</span><span class="s">*</span><span class="s">*</span><span class="s">/</span><span class="s">*</span><span class="s">.</span><span class="s">csproj</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<p>ScanImmediately() scans the FileSet immediatly at time of its definition
and memoizes it.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Includes all files under /src/app but excludes *.zip files</span>
<span class="c">//    eager scan ==&gt; All files memoized at the time of this definition</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs2', 3)" onmouseover="showTip(event, 'fs2', 3)" class="i">files</span> <span class="o">=</span> 
  <span class="o">!+</span> <span class="s">&quot;</span><span class="s">src</span><span class="s">/</span><span class="s">app</span><span class="s">/</span><span class="s">*</span><span class="s">*</span><span class="s">/</span><span class="s">*</span><span class="s">.</span><span class="s">csproj</span><span class="s">&quot;</span>
    <span class="o">--</span> <span class="s">&quot;</span><span class="s">*</span><span class="s">.</span><span class="s">zip</span><span class="s">&quot;</span>
    <span class="o">|&gt;</span> <span class="i">ScanImmediately</span></pre>
</td>
</tr>
</table>

<h2>UnitTests</h2>

<h3>NUnit</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// define test dlls</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 4)" onmouseover="showTip(event, 'fs3', 4)" class="i">testDlls</span> <span class="o">=</span> <span class="o">!!</span> (<span class="i">testDir</span> <span class="o">+</span> <span class="s">@&quot;</span><span class="s">/</span><span class="s">Test</span><span class="s">.</span><span class="s">*</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>)

<span class="i">Target</span> <span class="s">&quot;</span><span class="s">NUnitTest</span><span class="s">&quot;</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span>
    <span onmouseout="hideTip(event, 'fs3', 5)" onmouseover="showTip(event, 'fs3', 5)" class="i">testDlls</span>
        <span class="o">|&gt;</span> <span class="i">NUnit</span> (<span class="k">fun</span> <span class="i">p</span> <span class="k">-&gt;</span> 
            {<span class="i">p</span> <span class="k">with</span> 
                <span class="i">ToolPath</span> <span class="o">=</span> <span class="i">nunitPath</span>; 
                <span class="i">DisableShadowCopy</span> <span class="o">=</span> <span class="k">true</span>; 
                <span class="i">OutputFile</span> <span class="o">=</span> <span class="i">testDir</span> <span class="o">+</span> <span class="s">&quot;</span><span class="s">TestResults</span><span class="s">.</span><span class="s">xml</span><span class="s">&quot;</span>})
)</pre>
</td>
</tr>
</table>

<h3>MSpec</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// define test dlls</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 6)" onmouseover="showTip(event, 'fs3', 6)" class="i">testDlls</span> <span class="o">=</span> <span class="o">!!</span> (<span class="i">testDir</span> <span class="o">+</span> <span class="s">@&quot;</span><span class="s">/</span><span class="s">Test</span><span class="s">.</span><span class="s">*</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>)

<span class="i">Target</span> <span class="s">&quot;</span><span class="s">MSpecTest</span><span class="s">&quot;</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span>
    <span onmouseout="hideTip(event, 'fs3', 7)" onmouseover="showTip(event, 'fs3', 7)" class="i">testDlls</span>
        <span class="o">|&gt;</span> <span class="i">MSpec</span> (<span class="k">fun</span> <span class="i">p</span> <span class="k">-&gt;</span> 
            {<span class="i">p</span> <span class="k">with</span> 
                <span class="i">ExcludeTags</span> <span class="o">=</span> [<span class="s">&quot;</span><span class="s">LongRunning</span><span class="s">&quot;</span>]
                <span class="i">HtmlOutputDir</span> <span class="o">=</span> <span class="i">testOutputDir</span>                         
                <span class="i">ToolPath</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">.</span><span class="s">\t</span><span class="s">oools</span><span class="s">\</span><span class="s">MSpec</span><span class="s">\</span><span class="s">mspec</span><span class="s">.</span><span class="s">exe</span><span class="s">&quot;</span>})
)</pre>
</td>
</tr>
</table>

<h3>xUnit.net</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// define test dlls</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 8)" onmouseover="showTip(event, 'fs3', 8)" class="i">testDlls</span> <span class="o">=</span> <span class="o">!!</span> (<span class="i">testDir</span> <span class="o">+</span> <span class="s">@&quot;</span><span class="s">/</span><span class="s">Test</span><span class="s">.</span><span class="s">*</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>)

<span class="i">Target</span> <span class="s">&quot;</span><span class="s">xUnitTest</span><span class="s">&quot;</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span>
    <span onmouseout="hideTip(event, 'fs3', 9)" onmouseover="showTip(event, 'fs3', 9)" class="i">testDlls</span>
        <span class="o">|&gt;</span> <span class="i">xUnit</span> (<span class="k">fun</span> <span class="i">p</span> <span class="k">-&gt;</span> 
            {<span class="i">p</span> <span class="k">with</span> 
                <span class="i">ShadowCopy</span> <span class="o">=</span> <span class="k">false</span>;
                <span class="i">HtmlOutput</span> <span class="o">=</span> <span class="k">true</span>;
                <span class="i">XmlOutput</span> <span class="o">=</span> <span class="k">true</span>;
                <span class="i">OutputDir</span> <span class="o">=</span> <span class="i">testDir</span> })
)</pre>
</td>
</tr>
</table>

<h2>Sample script</h2>

<p>This sample script</p>

<ul>
<li>Assumes "FAKE - F# Make" is located at ./tools/FAKE</li>
<li>Assumes NUnit is located at ./tools/NUnit</li>
<li>Cleans the build and deploy paths</li>
<li>Builds all C# projects below src/app/ and puts the output to .\build</li>
<li>Builds all NUnit test projects below src/test/ and puts the output to .\build</li>
<li>Uses NUnit to test the generated Test.*.dll's</li>
<li>Zips all generated files to deploy\MyProject-0.1.zip</li>
</ul>

<p>You can read <a href="http://www.navision-blog.de/2009/04/01/getting-started-with-fake-a-f-sharp-make-tool">Getting started with FAKE</a> to build such a script.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">  1: </span>
<span class="l">  2: </span>
<span class="l">  3: </span>
<span class="l">  4: </span>
<span class="l">  5: </span>
<span class="l">  6: </span>
<span class="l">  7: </span>
<span class="l">  8: </span>
<span class="l">  9: </span>
<span class="l"> 10: </span>
<span class="l"> 11: </span>
<span class="l"> 12: </span>
<span class="l"> 13: </span>
<span class="l"> 14: </span>
<span class="l"> 15: </span>
<span class="l"> 16: </span>
<span class="l"> 17: </span>
<span class="l"> 18: </span>
<span class="l"> 19: </span>
<span class="l"> 20: </span>
<span class="l"> 21: </span>
<span class="l"> 22: </span>
<span class="l"> 23: </span>
<span class="l"> 24: </span>
<span class="l"> 25: </span>
<span class="l"> 26: </span>
<span class="l"> 27: </span>
<span class="l"> 28: </span>
<span class="l"> 29: </span>
<span class="l"> 30: </span>
<span class="l"> 31: </span>
<span class="l"> 32: </span>
<span class="l"> 33: </span>
<span class="l"> 34: </span>
<span class="l"> 35: </span>
<span class="l"> 36: </span>
<span class="l"> 37: </span>
<span class="l"> 38: </span>
<span class="l"> 39: </span>
<span class="l"> 40: </span>
<span class="l"> 41: </span>
<span class="l"> 42: </span>
<span class="l"> 43: </span>
<span class="l"> 44: </span>
<span class="l"> 45: </span>
<span class="l"> 46: </span>
<span class="l"> 47: </span>
<span class="l"> 48: </span>
<span class="l"> 49: </span>
<span class="l"> 50: </span>
<span class="l"> 51: </span>
<span class="l"> 52: </span>
<span class="l"> 53: </span>
<span class="l"> 54: </span>
<span class="l"> 55: </span>
<span class="l"> 56: </span>
<span class="l"> 57: </span>
<span class="l"> 58: </span>
<span class="l"> 59: </span>
<span class="l"> 60: </span>
<span class="l"> 61: </span>
<span class="l"> 62: </span>
<span class="l"> 63: </span>
<span class="l"> 64: </span>
<span class="l"> 65: </span>
<span class="l"> 66: </span>
<span class="l"> 67: </span>
<span class="l"> 68: </span>
<span class="l"> 69: </span>
<span class="l"> 70: </span>
<span class="l"> 71: </span>
<span class="l"> 72: </span>
<span class="l"> 73: </span>
<span class="l"> 74: </span>
<span class="l"> 75: </span>
<span class="l"> 76: </span>
<span class="l"> 77: </span>
<span class="l"> 78: </span>
<span class="l"> 79: </span>
<span class="l"> 80: </span>
<span class="l"> 81: </span>
<span class="l"> 82: </span>
<span class="l"> 83: </span>
<span class="l"> 84: </span>
<span class="l"> 85: </span>
<span class="l"> 86: </span>
<span class="l"> 87: </span>
<span class="l"> 88: </span>
<span class="l"> 89: </span>
<span class="l"> 90: </span>
<span class="l"> 91: </span>
<span class="l"> 92: </span>
<span class="l"> 93: </span>
<span class="l"> 94: </span>
<span class="l"> 95: </span>
<span class="l"> 96: </span>
<span class="l"> 97: </span>
<span class="l"> 98: </span>
<span class="l"> 99: </span>
<span class="l">100: </span>
<span class="l">101: </span>
<span class="l">102: </span>
<span class="l">103: </span>
<span class="l">104: </span>
<span class="l">105: </span>
<span class="l">106: </span>
<span class="l">107: </span>
<span class="l">108: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// include Fake libs</span>
# <span class="s">&quot;</span><span class="s">tools</span><span class="s">\</span><span class="s">FAKE</span><span class="s">&quot;</span>
# <span class="s">&quot;</span><span class="s">FakeLib</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>

<span class="k">open</span> <span class="i">Fake</span>

<span class="c">// Directories</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 10)" onmouseover="showTip(event, 'fs4', 10)" class="i">buildDir</span>  <span class="o">=</span> <span class="s">@&quot;</span><span class="s">.</span><span class="s">\</span><span class="s">build</span><span class="s">\</span><span class="s">&quot;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs5', 11)" onmouseover="showTip(event, 'fs5', 11)" class="i">testDir</span>   <span class="o">=</span> <span class="s">@&quot;</span><span class="s">.</span><span class="s">\</span><span class="s">test</span><span class="s">\</span><span class="s">&quot;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 12)" onmouseover="showTip(event, 'fs6', 12)" class="i">deployDir</span> <span class="o">=</span> <span class="s">@&quot;</span><span class="s">.</span><span class="s">\</span><span class="s">deploy</span><span class="s">\</span><span class="s">&quot;</span>

<span class="c">// tools</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs7', 13)" onmouseover="showTip(event, 'fs7', 13)" class="i">nunitPath</span> <span class="o">=</span> <span class="s">@&quot;</span><span class="s">.</span><span class="s">\</span><span class="s">Tools</span><span class="s">\</span><span class="s">NUnit</span><span class="s">&quot;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 14)" onmouseover="showTip(event, 'fs8', 14)" class="i">fxCopRoot</span> <span class="o">=</span> <span class="s">@&quot;</span><span class="s">.</span><span class="s">\</span><span class="s">Tools</span><span class="s">\</span><span class="s">FxCop</span><span class="s">\</span><span class="s">FxCopCmd</span><span class="s">.</span><span class="s">exe</span><span class="s">&quot;</span>

<span class="c">// Filesets</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 15)" onmouseover="showTip(event, 'fs9', 15)" class="i">appReferences</span>  <span class="o">=</span> 
    <span class="o">!+</span> <span class="s">@&quot;</span><span class="s">src</span><span class="s">\</span><span class="s">app</span><span class="s">\</span><span class="s">*</span><span class="s">*</span><span class="s">\</span><span class="s">*</span><span class="s">.</span><span class="s">csproj</span><span class="s">&quot;</span> 
      <span class="o">++</span> <span class="s">@&quot;</span><span class="s">src</span><span class="s">\</span><span class="s">app</span><span class="s">\</span><span class="s">*</span><span class="s">*</span><span class="s">\</span><span class="s">*</span><span class="s">.</span><span class="s">fsproj</span><span class="s">&quot;</span> 
        <span class="o">|&gt;</span> <span class="i">Scan</span>

<span class="k">let</span> <span class="i">testReferences</span> <span class="o">=</span> <span class="o">!!</span> <span class="s">@&quot;</span><span class="s">src</span><span class="s">\</span><span class="s">test</span><span class="s">\</span><span class="s">*</span><span class="s">*</span><span class="s">\</span><span class="s">*</span><span class="s">.</span><span class="s">csproj</span><span class="s">&quot;</span>

<span class="c">// version info</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs10', 16)" onmouseover="showTip(event, 'fs10', 16)" class="i">version</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">0</span><span class="s">.</span><span class="s">2</span><span class="s">&quot;</span>  <span class="c">// or retrieve from CI server</span>

<span class="c">// Targets</span>
<span class="i">Target</span> <span class="s">&quot;</span><span class="s">Clean</span><span class="s">&quot;</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span> 
    <span class="i">CleanDirs</span> [<span onmouseout="hideTip(event, 'fs4', 17)" onmouseover="showTip(event, 'fs4', 17)" class="i">buildDir</span>; <span onmouseout="hideTip(event, 'fs5', 18)" onmouseover="showTip(event, 'fs5', 18)" class="i">testDir</span>; <span onmouseout="hideTip(event, 'fs6', 19)" onmouseover="showTip(event, 'fs6', 19)" class="i">deployDir</span>]
)

<span class="i">Target</span> <span class="s">&quot;</span><span class="s">BuildApp</span><span class="s">&quot;</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span>
    <span class="i">AssemblyInfo</span> 
        (<span class="k">fun</span> <span class="i">p</span> <span class="k">-&gt;</span> 
        {<span class="i">p</span> <span class="k">with</span>
            <span class="i">CodeLanguage</span> <span class="o">=</span> <span class="i">CSharp</span>;
            <span class="i">AssemblyVersion</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 20)" onmouseover="showTip(event, 'fs10', 20)" class="i">version</span>;
            <span class="i">AssemblyTitle</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">Calculator</span><span class="s"> </span><span class="s">Command</span><span class="s"> </span><span class="s">line</span><span class="s"> </span><span class="s">tool</span><span class="s">&quot;</span>;
            <span class="i">AssemblyDescription</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">Sample</span><span class="s"> </span><span class="s">project</span><span class="s"> </span><span class="s">for</span><span class="s"> </span><span class="s">FAKE</span><span class="s"> </span><span class="s">-</span><span class="s"> </span><span class="s">F</span><span class="s">#</span><span class="s"> </span><span class="s">MAKE</span><span class="s">&quot;</span>;
            <span class="i">Guid</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">A539B42C</span><span class="s">-</span><span class="s">CB9F</span><span class="s">-</span><span class="s">4</span><span class="s">a23</span><span class="s">-</span><span class="s">8</span><span class="s">E57</span><span class="s">-</span><span class="s">AF4E7CEE5BAA</span><span class="s">&quot;</span>;
            <span class="i">OutputFileName</span> <span class="o">=</span> <span class="s">@&quot;</span><span class="s">.</span><span class="s">\</span><span class="s">src</span><span class="s">\</span><span class="s">app</span><span class="s">\</span><span class="s">Calculator</span><span class="s">\</span><span class="s">Properties</span><span class="s">\</span><span class="s">AssemblyInfo</span><span class="s">.</span><span class="s">cs</span><span class="s">&quot;</span>})

    <span class="i">AssemblyInfo</span> 
        (<span class="k">fun</span> <span class="i">p</span> <span class="k">-&gt;</span> 
        {<span class="i">p</span> <span class="k">with</span>
            <span class="i">CodeLanguage</span> <span class="o">=</span> <span class="i">CSharp</span>;
            <span class="i">AssemblyVersion</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 21)" onmouseover="showTip(event, 'fs10', 21)" class="i">version</span>;
            <span class="i">AssemblyTitle</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">Calculator</span><span class="s"> </span><span class="s">library</span><span class="s">&quot;</span>;
            <span class="i">AssemblyDescription</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">Sample</span><span class="s"> </span><span class="s">project</span><span class="s"> </span><span class="s">for</span><span class="s"> </span><span class="s">FAKE</span><span class="s"> </span><span class="s">-</span><span class="s"> </span><span class="s">F</span><span class="s">#</span><span class="s"> </span><span class="s">MAKE</span><span class="s">&quot;</span>;
            <span class="i">Guid</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">EE5621DB</span><span class="s">-</span><span class="s">B86B</span><span class="s">-</span><span class="s">44</span><span class="s">eb</span><span class="s">-</span><span class="s">987</span><span class="s">F</span><span class="s">-</span><span class="s">9</span><span class="s">C94BCC98441</span><span class="s">&quot;</span>;
            <span class="i">OutputFileName</span> <span class="o">=</span> <span class="s">@&quot;</span><span class="s">.</span><span class="s">\</span><span class="s">src</span><span class="s">\</span><span class="s">app</span><span class="s">\</span><span class="s">CalculatorLib</span><span class="s">\</span><span class="s">Properties</span><span class="s">\</span><span class="s">AssemblyInfo</span><span class="s">.</span><span class="s">cs</span><span class="s">&quot;</span>})          

    <span class="c">// compile all projects below src\app\</span>
    <span class="i">MSBuildRelease</span> <span onmouseout="hideTip(event, 'fs4', 22)" onmouseover="showTip(event, 'fs4', 22)" class="i">buildDir</span> <span class="s">&quot;</span><span class="s">Build</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs9', 23)" onmouseover="showTip(event, 'fs9', 23)" class="i">appReferences</span>
        <span class="o">|&gt;</span> <span class="i">Log</span> <span class="s">&quot;</span><span class="s">AppBuild</span><span class="s">-</span><span class="s">Output</span><span class="s">:</span><span class="s"> </span><span class="s">&quot;</span>
)

<span class="i">Target</span> <span class="s">&quot;</span><span class="s">BuildTest</span><span class="s">&quot;</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span>
    <span class="i">MSBuildDebug</span> <span onmouseout="hideTip(event, 'fs5', 24)" onmouseover="showTip(event, 'fs5', 24)" class="i">testDir</span> <span class="s">&quot;</span><span class="s">Build</span><span class="s">&quot;</span> <span class="i">testReferences</span>
        <span class="o">|&gt;</span> <span class="i">Log</span> <span class="s">&quot;</span><span class="s">TestBuild</span><span class="s">-</span><span class="s">Output</span><span class="s">:</span><span class="s"> </span><span class="s">&quot;</span>
)

<span class="i">Target</span> <span class="s">&quot;</span><span class="s">NUnitTest</span><span class="s">&quot;</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span>  
    <span class="o">!!</span> (<span onmouseout="hideTip(event, 'fs5', 25)" onmouseover="showTip(event, 'fs5', 25)" class="i">testDir</span> <span class="o">+</span> <span class="s">@&quot;</span><span class="s">\</span><span class="s">NUnit</span><span class="s">.</span><span class="s">Test</span><span class="s">.</span><span class="s">*</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>)
        <span class="o">|&gt;</span> <span class="i">NUnit</span> (<span class="k">fun</span> <span class="i">p</span> <span class="k">-&gt;</span> 
            {<span class="i">p</span> <span class="k">with</span> 
                <span class="i">ToolPath</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 26)" onmouseover="showTip(event, 'fs7', 26)" class="i">nunitPath</span>; 
                <span class="i">DisableShadowCopy</span> <span class="o">=</span> <span class="k">true</span>; 
                <span class="i">OutputFile</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 27)" onmouseover="showTip(event, 'fs5', 27)" class="i">testDir</span> <span class="o">+</span> <span class="s">@&quot;</span><span class="s">TestResults</span><span class="s">.</span><span class="s">xml</span><span class="s">&quot;</span>})
)

<span class="i">Target</span> <span class="s">&quot;</span><span class="s">xUnitTest</span><span class="s">&quot;</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span>  
    <span class="o">!!</span> (<span onmouseout="hideTip(event, 'fs5', 28)" onmouseover="showTip(event, 'fs5', 28)" class="i">testDir</span> <span class="o">+</span> <span class="s">@&quot;</span><span class="s">\</span><span class="s">xUnit</span><span class="s">.</span><span class="s">Test</span><span class="s">.</span><span class="s">*</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>)
        <span class="o">|&gt;</span> <span class="i">xUnit</span> (<span class="k">fun</span> <span class="i">p</span> <span class="k">-&gt;</span> 
            {<span class="i">p</span> <span class="k">with</span> 
                <span class="i">ShadowCopy</span> <span class="o">=</span> <span class="k">false</span>;
                <span class="i">HtmlOutput</span> <span class="o">=</span> <span class="k">true</span>;
                <span class="i">XmlOutput</span> <span class="o">=</span> <span class="k">true</span>;
                <span class="i">OutputDir</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 29)" onmouseover="showTip(event, 'fs5', 29)" class="i">testDir</span> })
)

<span class="i">Target</span> <span class="s">&quot;</span><span class="s">FxCop</span><span class="s">&quot;</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span>
    <span class="o">!+</span> (<span onmouseout="hideTip(event, 'fs4', 30)" onmouseover="showTip(event, 'fs4', 30)" class="i">buildDir</span> <span class="o">+</span> <span class="s">@&quot;</span><span class="s">\</span><span class="s">*</span><span class="s">*</span><span class="s">\</span><span class="s">*</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>) 
        <span class="o">++</span> (<span onmouseout="hideTip(event, 'fs4', 31)" onmouseover="showTip(event, 'fs4', 31)" class="i">buildDir</span> <span class="o">+</span> <span class="s">@&quot;</span><span class="s">\</span><span class="s">*</span><span class="s">*</span><span class="s">\</span><span class="s">*</span><span class="s">.</span><span class="s">exe</span><span class="s">&quot;</span>) 
        <span class="o">|&gt;</span> <span class="i">Scan</span>  
        <span class="o">|&gt;</span> <span class="i">FxCop</span> (<span class="k">fun</span> <span class="i">p</span> <span class="k">-&gt;</span> 
            {<span class="i">p</span> <span class="k">with</span>                     
                <span class="i">ReportFileName</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 32)" onmouseover="showTip(event, 'fs5', 32)" class="i">testDir</span> <span class="o">+</span> <span class="s">&quot;</span><span class="s">FXCopResults</span><span class="s">.</span><span class="s">xml</span><span class="s">&quot;</span>;
                <span class="i">ToolPath</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs8', 33)" onmouseover="showTip(event, 'fs8', 33)" class="i">fxCopRoot</span>})
)

<span class="i">Target</span> <span class="s">&quot;</span><span class="s">Deploy</span><span class="s">&quot;</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span>
    <span class="o">!+</span> (<span onmouseout="hideTip(event, 'fs4', 34)" onmouseover="showTip(event, 'fs4', 34)" class="i">buildDir</span> <span class="o">+</span> <span class="s">&quot;</span><span class="s">\</span><span class="s">*</span><span class="s">*</span><span class="s">\</span><span class="s">*</span><span class="s">.</span><span class="s">*</span><span class="s">&quot;</span>) 
        <span class="o">--</span> <span class="s">&quot;</span><span class="s">*</span><span class="s">.</span><span class="s">zip</span><span class="s">&quot;</span> 
        <span class="o">|&gt;</span> <span class="i">Scan</span>
        <span class="o">|&gt;</span> <span class="i">Zip</span> <span onmouseout="hideTip(event, 'fs4', 35)" onmouseover="showTip(event, 'fs4', 35)" class="i">buildDir</span> (<span onmouseout="hideTip(event, 'fs6', 36)" onmouseover="showTip(event, 'fs6', 36)" class="i">deployDir</span> <span class="o">+</span> <span class="s">&quot;</span><span class="s">Calculator</span><span class="s">.</span><span class="s">&quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs10', 37)" onmouseover="showTip(event, 'fs10', 37)" class="i">version</span> <span class="o">+</span> <span class="s">&quot;</span><span class="s">.</span><span class="s">zip</span><span class="s">&quot;</span>)
)

<span class="c">// Build order</span>
<span class="s">&quot;</span><span class="s">Clean</span><span class="s">&quot;</span>
  <span class="o">==&gt;</span> <span class="s">&quot;</span><span class="s">BuildApp</span><span class="s">&quot;</span> <span class="o">&lt;=&gt;</span> <span class="s">&quot;</span><span class="s">BuildTest</span><span class="s">&quot;</span>
  <span class="o">==&gt;</span> <span class="s">&quot;</span><span class="s">FxCop</span><span class="s">&quot;</span>
  <span class="o">==&gt;</span> <span class="s">&quot;</span><span class="s">NUnitTest</span><span class="s">&quot;</span>
  <span class="o">=?&gt;</span> (<span class="s">&quot;</span><span class="s">xUnitTest</span><span class="s">&quot;</span>,<span class="i">hasBuildParam</span> <span class="s">&quot;</span><span class="s">xUnitTest</span><span class="s">&quot;</span>)  <span class="c">// runs the target only if FAKE was called with parameter xUnitTest</span>
  <span class="o">==&gt;</span> <span class="s">&quot;</span><span class="s">Deploy</span><span class="s">&quot;</span>

<span class="c">// start build</span>
<span class="i">Run</span> <span class="s">&quot;</span><span class="s">Deploy</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<h2>Deployment using FAKE</h2>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="o">*</span> <span class="i">Assumes</span> <span class="i">Fake</span><span class="o">.</span><span class="i">Deploy</span><span class="o">.</span><span class="i">exe</span> <span class="i">is</span> <span class="i">available</span> <span class="k">in</span> <span class="i">the</span> <span class="i">current</span> <span class="i">directory</span> <span class="k">or</span> <span class="i">path</span><span class="o">.</span></pre>
</td>
</tr>
</table>

<h3>Introduction</h3>

<p>The FAKE deployment tool allows users to deploy applications to remote computers and to run scripts on these remote agents. A typical scenario maybe as follows:</p>

<ul>
<li>Build an application -> run tests -> create artifacts and save on build server (Classical FAKE build workflow)</li>
<li>Extract artifacts from build server and create a NuGet deployment package</li>
<li>Push the NuGet package to the desired computer this will run the package's FAKE script on the remote machine</li>
</ul>

<h3>Installing Fake deployment services</h3>

<p>In order to deploy application to a remote computer a deployment agent needs to be running on that server.</p>

<p>To run an agent in a console, simply run:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="i">Fake</span><span class="o">.</span><span class="i">Deploy</span></pre>
</td>
</tr>
</table>

<p>To install a windows service on that agent:</p>

<ul>
<li>Open a command prompt with Administrator Priviledges</li>
<li>Run Fake.Deploy /install</li>
</ul>

<p>By default the service starts a listener on port 8080. This can however be configured by editing the Fake.Deploy.exe.config file
and changing</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="o">&lt;</span><span class="i">add</span> <span class="i">key</span><span class="o">=</span><span class="s">&quot;</span><span class="s">ServerName</span><span class="s">&quot;</span> <span class="i">value</span><span class="o">=</span><span class="s">&quot;</span><span class="s">localhost</span><span class="s">&quot;</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="i">add</span> <span class="i">key</span><span class="o">=</span><span class="s">&quot;</span><span class="s">Port</span><span class="s">&quot;</span> <span class="i">value</span><span class="o">=</span><span class="s">&quot;</span><span class="s">8080</span><span class="s">&quot;</span> <span class="o">/&gt;</span></pre>
</td>
</tr>
</table>

<p>to the desired value. If you use the asterisk as port no. then Fake.Deploy will assign the first open port behind of 8080.</p>

<p>To ensure the service is running you can navigate to http://{computer}:{port}/fake/ and you should be presented with a page giving the 
status if the service</p>

<h3>Uninstalling Fake deployment services</h3>

<p>To uninstall an agent</p>

<ul>
<li>Open a command prompt with Administrator Priviledges</li>
<li>Run Fake.Deploy /uninstall</li>
</ul>

<h3>Running a FAKE Deployment Package</h3>

<h3>Getting help</h3>

<p>If you want to learn about Fake.Deploy's command line switches then run:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="i">Fake</span><span class="o">.</span><span class="i">Deploy</span> <span class="o">/</span><span class="i">help</span></pre>
</td>
</tr>
</table>

<h3>Creating a Deployment package</h3>

<p>Since Fake.Deploy uses Nuget packages for deployment you only need to create one of those and include a .fsx file in the root folder of the package.</p>

<p>Instructions for creating nuget packages can be found <a href="http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package">at the NuGet document page</a></p>

<h3>Running deployment</h3>

<p>Fake deployment packages can be run manually on the current machine or they can be pushed to an agent on a remote machine.</p>

<p>To run a package on the local machine located at C:\Appdev\MyDeployment.nupkg you would run the following command:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="i">Fake</span><span class="o">.</span><span class="i">Deploy</span> <span class="o">/</span><span class="i">deploy</span> <span class="i">C</span><span class="o">:</span></pre>
</td>
</tr>
</table>

<p>To run the same package on a remote computer (e.g. integration-1) you can run:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="i">Fake</span><span class="o">.</span><span class="i">Deploy</span> <span class="o">/</span><span class="i">deployRemote</span> <span class="i">http</span><span class="o">:</span><span class="c">//integration-1:8080 C:\Appdev\MyDeployment.nupkg </span></pre>
</td>
</tr>
</table>

<p>It's also possible to just make a HTTP-POST with the package to http://integration-1:8080/fake</p>

<p>This will push the directory to the given url. It is worth noting that the port may well be different, as this depends on the configuration of the 
listening agent (see. Installing Fake deployment service)</p>

<h3>Getting information about the deployments</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="i">The</span> <span class="i">following</span> <span class="i">assumes</span> <span class="i">you</span> <span class="i">have</span> <span class="i">Fake</span><span class="o">.</span><span class="i">Deploy</span> <span class="i">running</span><span class="o">.</span></pre>
</td>
</tr>
</table>

<p>It's easy to get information about the deployments. Just make a HTTP request to server with:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="i">fake</span><span class="o">/</span><span class="i">deployments</span><span class="o">/</span>                     <span class="k">-&gt;</span> <span class="i">gives</span> <span class="i">all</span> <span class="i">releases</span>
<span class="i">fake</span><span class="o">/</span><span class="i">deployments</span><span class="o">?</span><span class="i">status</span><span class="o">=</span><span class="i">active</span>        <span class="k">-&gt;</span> <span class="i">gives</span> <span class="i">all</span> <span class="i">active</span> <span class="i">releases</span>
<span class="i">fake</span><span class="o">/</span><span class="i">deployments</span><span class="o">/</span>{<span class="i">app</span>}                <span class="k">-&gt;</span> <span class="i">gives</span> <span class="i">all</span> <span class="i">releases</span> <span class="k">of</span> <span class="i">app</span>
<span class="i">fake</span><span class="o">/</span><span class="i">deployments</span><span class="o">/</span>{<span class="i">app</span>}<span class="o">?</span><span class="i">status</span><span class="o">=</span><span class="i">active</span>  <span class="k">-&gt;</span> <span class="i">gives</span> <span class="i">the</span> <span class="i">active</span> <span class="i">release</span> <span class="k">of</span> <span class="i">the</span> <span class="i">app</span></pre>
</td>
</tr>
</table>

<h3>Rollback of releases</h3>

<p>If you want to perform a rollback of a release so do a HTTP-PUT to:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="i">fake</span><span class="o">/</span><span class="i">deployments</span><span class="o">/</span>{<span class="i">app</span>}<span class="o">?</span><span onmouseout="hideTip(event, 'fs10', 38)" onmouseover="showTip(event, 'fs10', 38)" class="i">version</span><span class="o">=</span>{<span onmouseout="hideTip(event, 'fs10', 39)" onmouseover="showTip(event, 'fs10', 39)" class="i">version</span>} <span class="k">-&gt;</span> <span class="i">rolls</span> <span class="i">the</span> <span class="i">app</span> <span class="i">back</span> <span class="k">to</span> <span class="i">the</span> <span class="i">given</span> <span onmouseout="hideTip(event, 'fs10', 40)" onmouseover="showTip(event, 'fs10', 40)" class="i">version</span>
<span class="i">fake</span><span class="o">/</span><span class="i">deployments</span><span class="o">/</span>{<span class="i">app</span>}<span class="o">?</span><span onmouseout="hideTip(event, 'fs10', 41)" onmouseover="showTip(event, 'fs10', 41)" class="i">version</span><span class="o">=</span><span class="i">HEAD</span><span class="k">~</span><span class="n">2</span>    <span class="k">-&gt;</span> <span class="i">relative</span> <span class="i">rollback</span> <span class="k">of</span> <span class="i">the</span> <span class="i">app</span> (<span class="i">two</span> <span class="i">versions</span> <span class="i">earlier</span>)</pre>
</td>
</tr>
</table>

          <div class="tip" id="fs1">val apps : &#39;a<br /><br />Full name: overview.apps</div>
<div class="tip" id="fs2">val files : &#39;a<br /><br />Full name: overview.files</div>
<div class="tip" id="fs3">val testDlls : &#39;_arg2<br /><br />Full name: overview.testDlls</div>
<div class="tip" id="fs4">val buildDir : string<br /><br />Full name: overview.buildDir</div>
<div class="tip" id="fs5">val testDir : string<br /><br />Full name: overview.testDir</div>
<div class="tip" id="fs6">val deployDir : string<br /><br />Full name: overview.deployDir</div>
<div class="tip" id="fs7">val nunitPath : string<br /><br />Full name: overview.nunitPath</div>
<div class="tip" id="fs8">val fxCopRoot : string<br /><br />Full name: overview.fxCopRoot</div>
<div class="tip" id="fs9">val appReferences : &#39;a<br /><br />Full name: overview.appReferences</div>
<div class="tip" id="fs10">val version : string<br /><br />Full name: overview.version</div>
          
        </div>
        <div class="span3">

          <ul class="nav nav-list" id="menu">
            <li class="nav-header">FAKE - F# Make</li>
            <li><a href="../index.html">Home page</a></li>
            <!--

              Here you can add links to other pages of the documentation 
              The 'divider' element creates a separator and additional
              'nav-header' can be used to add sub-headings in the menu:

              * <li class="divider"></li>
              * <li><a href="...">...</a></li>
              * <li class="nav-header">Sub-heading</li>

            -->
          </ul>
        </div>
      </div>
    </div>
    <a href="https://github.com/fsharp/FAKE"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
  </body>
  </html>